#python3
import json
import xml.etree.cElementTree as e

with open("VRS.json") as json_format_file: 
  d = json.load(json_format_file)
  print(d)
  r = e.Element("Document")
for row in d:
  it = e.SubElement(r,"Item")
  e.SubElement(it,"UUID").text = row["UUID"]
  e.SubElement(it,"ReportingDate").text = row["ReportingDate"]
  sys = e.SubElement(it,"Systems")
  for sy in row["Systems"]:
    if sy != '':
      e.SubElement(sys,sy.split(":")[0]).text = sy.split(":")[1]
  e.SubElement(it,"Title").text = row["Title"]
  e.SubElement(it,"Description").text = row["Description"]
  e.SubElement(it,"Risk").text = row["Risk"]
  cve = e.SubElement(it,"CVES")
  for cv in row["CVES"]:
    if cv != '':
      e.SubElement(cve,"CVE").text = cv
  e.SubElement(it,"MitigationAdvisory").text = row["MitigationAdvisory"]
  sev = e.SubElement(it,"SeverityScore")
  for se in row["SecurityScore"]:
    if se != '':
      e.SubElement(sev,se.split(":")[0]).text = se.split(":")[1]
  pub = e.SubElement(it,"PublicExploit")
  for pu in row["PublicExploit"]:
    if pu != '':
      e.SubElement(pub,pu.split(":")[0]).text = pu.split(":")[1] + ":" + pu.split(":")[2]
  ref = e.SubElement(it,"Reference")
  for re in row["Reference"]:
    if re != '':
      e.SubElement(ref,"Ref").text = re

a = e.ElementTree(r)
a.write("VRS.xml")
